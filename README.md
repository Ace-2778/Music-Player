# ğŸµ Music Player

ä¸€ä¸ªåŸºäº Electron + React çš„ç°ä»£åŒ–æœ¬åœ°éŸ³ä¹æ’­æ”¾å™¨ï¼Œæ”¯æŒåœ¨çº¿æ­Œè¯åŒæ­¥ã€ä¸“è¾‘å°é¢æ˜¾ç¤ºå’Œæ™ºèƒ½éŸ³ä¹ç®¡ç†ã€‚

![Platform](https://img.shields.io/badge/platform-Windows%20%7C%20macOS%20%7C%20Linux-lightgrey)
![License](https://img.shields.io/badge/license-MIT-blue)

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¼ éŸ³ä¹æ’­æ”¾
- **å®Œæ•´æ’­æ”¾æ§åˆ¶**ï¼šæ’­æ”¾/æš‚åœã€ä¸Šä¸€æ›²/ä¸‹ä¸€æ›²ã€è¿›åº¦æ¡æ‹–æ‹½ã€éŸ³é‡è°ƒèŠ‚
- **éŸ³é¢‘å…ƒæ•°æ®è§£æ**ï¼šè‡ªåŠ¨è¯»å–éŸ³é¢‘æ–‡ä»¶çš„æ ‡é¢˜ã€è‰ºæœ¯å®¶ã€ä¸“è¾‘ã€æ—¶é•¿ä¿¡æ¯
- **æ–‡ä»¶å¤¹æ‰«æ**ï¼šé€’å½’æ‰«æéŸ³ä¹æ–‡ä»¶å¤¹ï¼Œæ”¯æŒ MP3ã€FLACã€WAV ç­‰ä¸»æµæ ¼å¼
- **æŒä¹…åŒ–é…ç½®**ï¼šéŸ³é‡è®¾ç½®è‡ªåŠ¨ä¿å­˜ï¼Œä¸‹æ¬¡å¯åŠ¨æ¢å¤

### ğŸ¨ ç°ä»£åŒ– UI
- **æç®€è®¾è®¡**ï¼šç²¾å¿ƒæ‰“ç£¨çš„ç•Œé¢ï¼Œä¸“æ³¨äºå†…å®¹å‘ˆç°
- **å“åº”å¼å¸ƒå±€**ï¼šæœ€å°çª—å£å°ºå¯¸ 1100x700ï¼Œé€‚é…ä¸åŒå±å¹•
- **ä¸“è¾‘å°é¢**ï¼š
  - ä¼˜å…ˆæ˜¾ç¤ºéŸ³é¢‘æ–‡ä»¶å†…åµŒå°é¢
  - è‡ªåŠ¨ä» iTunes API æœç´¢åœ¨çº¿å°é¢
  - å°é¢ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚

### ğŸ“– åœ¨çº¿æ­Œè¯åŒæ­¥
- **LRC æ ¼å¼æ”¯æŒ**ï¼šç²¾ç¡®åˆ°æ¯«ç§’çš„æ—¶é—´æˆ³åŒæ­¥
- **åœ¨çº¿æ­Œè¯è·å–**ï¼š
  - ä¸»æºï¼šLRCLIBï¼ˆä¼˜å…ˆï¼Œæ”¯æŒ LRC æ ¼å¼ï¼‰
  - å¤‡ç”¨æºï¼šlyrics.ovhï¼ˆçº¯æ–‡æœ¬ï¼‰
  - 8ç§’è¶…æ—¶ + ç«æ€æ§åˆ¶ï¼Œä¿è¯å“åº”é€Ÿåº¦
- **æ™ºèƒ½æ­Œè¯æ˜¾ç¤º**ï¼š
  - å½“å‰è¡Œé«˜äº® + è‡ªåŠ¨å±…ä¸­æ»šåŠ¨
  - äºŒåˆ†æŸ¥æ‰¾ç®—æ³•ï¼ˆO(log n)ï¼‰ä¼˜åŒ–æ€§èƒ½
  - ç‚¹å‡»æ­Œè¯è¡Œè·³è½¬æ’­æ”¾æ—¶é—´
  - æ”¯æŒçº¯æ–‡æœ¬æ­Œè¯æ‰‹åŠ¨æ»šåŠ¨
- **å­—å·è‡ªå®šä¹‰**ï¼š
  - å³é”®èœå•å¿«é€Ÿè°ƒæ•´ï¼ˆ12-28pxï¼‰
  - å¿«æ·é”®æ”¯æŒï¼š`Ctrl +` å¢å¤§ã€`Ctrl -` å‡å°ã€`Ctrl 0` é‡ç½®
  - å­—å·æŒä¹…åŒ–ï¼Œé‡å¯ä¿æŒ

### ğŸ¯ äº¤äº’ä½“éªŒ
- **æœç´¢åŠŸèƒ½**ï¼šå®æ—¶æœç´¢æ ‡é¢˜/è‰ºæœ¯å®¶
- **æ’åºåŠŸèƒ½**ï¼šæŒ‰æ ‡é¢˜/è‰ºæœ¯å®¶æ’åº
- **é”®ç›˜å¿«æ·é”®**ï¼š
  - `Space`ï¼šæ’­æ”¾/æš‚åœ
  - `â†‘/â†“`ï¼šéŸ³é‡ Â±5
  - `ESC`ï¼šå…³é—­æ­Œè¯é¡µ
  - `Ctrl +/-/0`ï¼šæ­Œè¯å­—å·è°ƒæ•´ï¼ˆæ­Œè¯é¡µå†…ï¼‰
- **è¦†ç›–å±‚æ­Œè¯**ï¼š
  - ç‚¹å‡»ä¸“è¾‘å°é¢æ‰“å¼€å…¨å±æ­Œè¯é¡µ
  - å·¦ä¾§å°é¢å±•ç¤º + å³ä¾§æ­Œè¯æ»šåŠ¨
  - ç‚¹å‡»é®ç½©æˆ–æŒ‰ ESC å…³é—­

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Electron 30.0.1**ï¼šè·¨å¹³å°æ¡Œé¢åº”ç”¨æ¡†æ¶
- **React 18.2.0**ï¼šUI æ„å»º
- **TypeScript**ï¼šç±»å‹å®‰å…¨
- **Zustand 5.0.9**ï¼šè½»é‡çº§çŠ¶æ€ç®¡ç†
- **Framer Motion 12.23.26**ï¼šæµç•…åŠ¨ç”»æ•ˆæœ
- **Vite**ï¼šå¿«é€Ÿå¼€å‘æ„å»ºå·¥å…·

### æ ¸å¿ƒåº“
- **music-metadata 11.10.3**ï¼šéŸ³é¢‘å…ƒæ•°æ®è§£æ
- **electron-store 11.0.2**ï¼šé…ç½®æŒä¹…åŒ–å­˜å‚¨

### æ¶æ„ç‰¹ç‚¹
- **å®‰å…¨ IPC é€šä¿¡**ï¼š`contextIsolation: true` + `nodeIntegration: false`
- **Provider æ¶æ„**ï¼šå¯æ‰©å±•çš„éŸ³ä¹æºç®¡ç†ï¼ˆæœ¬åœ°/åœ¨çº¿/Mockï¼‰
- **LRC è§£æå™¨**ï¼šæ”¯æŒå¤šæ—¶é—´æˆ³ã€æ¯«ç§’ç²¾åº¦è§£æ
- **ç¼“å­˜ç­–ç•¥**ï¼š
  - ä¸“è¾‘å°é¢ URL ç¼“å­˜ï¼ˆelectron-storeï¼‰
  - æ­Œè¯ç»“æœç¼“å­˜ï¼ˆå†…å­˜ç¼“å­˜ + ç«æ€æ§åˆ¶ï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 16+ 
- npm æˆ– yarn

### å®‰è£…ä¾èµ–
```bash
npm install
# æˆ–
yarn install
```

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```
åº”ç”¨ä¼šåœ¨å¼€å‘æ¨¡å¼ä¸‹å¯åŠ¨ï¼Œæ”¯æŒçƒ­é‡è½½ã€‚

### æ„å»ºæ‰“åŒ…
```bash
npm run build
```
ä¼šç”Ÿæˆå¯¹åº”å¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
Music-Player/
â”œâ”€â”€ electron/                 # Electron ä¸»è¿›ç¨‹
â”‚   â”œâ”€â”€ main.ts              # ä¸»è¿›ç¨‹å…¥å£ï¼ŒIPC å¤„ç†
â”‚   â””â”€â”€ preload.ts           # é¢„åŠ è½½è„šæœ¬ï¼Œå®‰å…¨æ¡¥æ¥
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ TopBar.tsx       # é¡¶éƒ¨æ ï¼ˆæœç´¢/æ’åºï¼‰
â”‚   â”‚   â”œâ”€â”€ TrackList.tsx    # æ›²ç›®åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ PlayerBar.tsx    # åº•éƒ¨æ’­æ”¾å™¨
â”‚   â”‚   â””â”€â”€ LyricsOverlay.tsx # æ­Œè¯è¦†ç›–å±‚
â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â””â”€â”€ playerStore.ts   # Zustand çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ providers/           # éŸ³ä¹æº Provider
â”‚   â”‚   â”œâ”€â”€ LocalProvider.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ lyricsService.ts # åœ¨çº¿æ­Œè¯è·å–
â”‚   â”‚   â”œâ”€â”€ lrcParser.ts     # LRC æ ¼å¼è§£æ
â”‚   â”‚   â””â”€â”€ coverSearch.ts   # å°é¢æœç´¢
â”‚   â””â”€â”€ types/               # TypeScript ç±»å‹å®šä¹‰
â”‚       â””â”€â”€ lyrics.ts
â”œâ”€â”€ dist/                    # æ„å»ºè¾“å‡ºï¼ˆå‰ç«¯ï¼‰
â”œâ”€â”€ dist-electron/           # æ„å»ºè¾“å‡ºï¼ˆElectronï¼‰
â””â”€â”€ package.json
```

## ğŸ® ä½¿ç”¨æŒ‡å—

> **ğŸ’¡ æ¨èçª—å£å°ºå¯¸**ï¼šå»ºè®®ä½¿ç”¨æœ€å°çª—å£å°ºå¯¸ï¼ˆ1100x700ï¼‰è¿è¡Œåº”ç”¨ä»¥è·å¾—æœ€ä½³è§†è§‰æ•ˆæœã€‚è¿‡å¤§çš„çª—å£å°ºå¯¸å¯èƒ½å¯¼è‡´ç•Œé¢å…ƒç´ åˆ†å¸ƒä¸å‡ï¼Œå½±å“ä½¿ç”¨ä½“éªŒã€‚

### 1. æ·»åŠ éŸ³ä¹
ç‚¹å‡» **"é€‰æ‹©æ–‡ä»¶å¤¹"** æŒ‰é’®ï¼Œé€‰æ‹©åŒ…å«éŸ³ä¹æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚åº”ç”¨ä¼šè‡ªåŠ¨æ‰«æå¹¶å¯¼å…¥æ‰€æœ‰æ”¯æŒçš„éŸ³é¢‘æ–‡ä»¶ã€‚

### 2. æ’­æ”¾éŸ³ä¹
- ç‚¹å‡»æ›²ç›®åˆ—è¡¨ä¸­çš„ä»»æ„æ­Œæ›²å¼€å§‹æ’­æ”¾
- ä½¿ç”¨åº•éƒ¨æ’­æ”¾å™¨æ§åˆ¶æ’­æ”¾/æš‚åœã€åˆ‡æ­Œã€è°ƒèŠ‚éŸ³é‡
- æ‹–åŠ¨è¿›åº¦æ¡è·³è½¬åˆ°æŒ‡å®šä½ç½®

### 3. æŸ¥çœ‹æ­Œè¯
- ç‚¹å‡»åº•éƒ¨æ’­æ”¾å™¨å·¦ä¾§çš„ä¸“è¾‘å°é¢æ‰“å¼€æ­Œè¯é¡µ
- æ­Œè¯ä¼šè‡ªåŠ¨åŒæ­¥é«˜äº®å½“å‰æ’­æ”¾çš„è¡Œ
- ç‚¹å‡»æ­Œè¯è¡Œå¯è·³è½¬åˆ°å¯¹åº”æ—¶é—´ç‚¹
- å³é”®æ­Œè¯åŒºåŸŸè°ƒæ•´å­—å·

### 4. å¿«æ·é”®
- **ç©ºæ ¼**ï¼šæ’­æ”¾/æš‚åœ
- **æ–¹å‘é”®ä¸Š/ä¸‹**ï¼šéŸ³é‡å¢å‡
- **ESC**ï¼šå…³é—­æ­Œè¯é¡µ
- **Ctrl +**ï¼šå¢å¤§æ­Œè¯å­—å·
- **Ctrl -**ï¼šå‡å°æ­Œè¯å­—å·
- **Ctrl 0**ï¼šé‡ç½®æ­Œè¯å­—å·

## ğŸ”§ é…ç½®è¯´æ˜

åº”ç”¨é…ç½®é€šè¿‡ `electron-store` æŒä¹…åŒ–å­˜å‚¨åœ¨ï¼š
- Windows: `%APPDATA%/music-player/config.json`
- macOS: `~/Library/Application Support/music-player/config.json`
- Linux: `~/.config/music-player/config.json`

### é…ç½®é¡¹
```json
{
  "volume": 80,                    // éŸ³é‡ï¼ˆ0-100ï¼‰
  "trackCovers": {},               // å°é¢ URL ç¼“å­˜
  "lyricsOptions": {               // æ­Œè¯æ˜¾ç¤ºé€‰é¡¹
    "align": "left",
    "fontFamily": "system-ui, sans-serif",
    "fontSize": 20,
    "lineHeight": 1.8
  }
}
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°

### æ­Œè¯åŒæ­¥ç®—æ³•
ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾åœ¨ O(log n) æ—¶é—´å¤æ‚åº¦å†…æ‰¾åˆ°å½“å‰æ’­æ”¾æ—¶é—´å¯¹åº”çš„æ­Œè¯è¡Œï¼š

```typescript
const getActiveLyricIndex = (lines: LyricsLine[], currentTimeMs: number) => {
  let left = 0, right = lines.length - 1, result = -1
  while (left <= right) {
    const mid = Math.floor((left + right) / 2)
    if (lines[mid].timeMs <= currentTimeMs) {
      result = mid
      left = mid + 1
    } else {
      right = mid - 1
    }
  }
  return result
}
```

### åœ¨çº¿æ­Œè¯è·å–ç­–ç•¥
1. ä¼˜å…ˆä» LRCLIB è·å–å¸¦æ—¶é—´æˆ³çš„ LRC æ ¼å¼æ­Œè¯
2. è‹¥å¤±è´¥ï¼Œä» lyrics.ovh è·å–çº¯æ–‡æœ¬æ­Œè¯
3. å†…å­˜ç¼“å­˜ + è¯·æ±‚ ID é˜²æ­¢ç«æ€æ¡ä»¶
4. 8 ç§’è¶…æ—¶ä¿è¯å“åº”é€Ÿåº¦

### å®‰å…¨çš„ IPC é€šä¿¡
ä½¿ç”¨ contextBridge åœ¨ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹é—´å®‰å…¨é€šä¿¡ï¼š

```typescript
// preload.ts
contextBridge.exposeInMainWorld('electronAPI', {
  scanMusicFolder: (path) => ipcRenderer.invoke('scan-music-folder', path),
  getLyricsOptions: () => ipcRenderer.invoke('get-lyrics-options'),
  // ...
})
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘å»ºè®®
1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“ å¾…å®ç°åŠŸèƒ½
- [ ] æ’­æ”¾åˆ—è¡¨ç®¡ç†ï¼ˆåˆ›å»º/ç¼–è¾‘/åˆ é™¤ï¼‰
- [ ] æ’­æ”¾å†å²è®°å½•
- [ ] éŸ³ä¹æ ‡ç­¾ç¼–è¾‘
- [ ] å‡è¡¡å™¨æ”¯æŒ
- [ ] ä¸»é¢˜è‡ªå®šä¹‰
- [ ] macOS/Linux å¹³å°æµ‹è¯•å’Œä¼˜åŒ–
- [ ] æ›´å¤šåœ¨çº¿éŸ³ä¹æºæ”¯æŒ

## ğŸ“„ å¼€æºåè®®

MIT License

---

**â­ å¦‚æœè§‰å¾—è¿™ä¸ªé¡¹ç›®ä¸é”™ï¼Œè¯·ç»™ä¸ª Star æ”¯æŒä¸€ä¸‹ï¼**
